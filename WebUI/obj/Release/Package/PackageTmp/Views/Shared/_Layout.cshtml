<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    @*<title>@ViewBag.Title - My ASP.NET Application</title>*@

    @*@Styles.Render("~/Content/css")
        @Scripts.Render("~/bundles/modernizr")*@

    <link href="~/Scripts/IgGrid/infragistics.css" rel="stylesheet" />
    <link href="~/Scripts/jsgrid/jsgrid.min.css" rel="stylesheet" />
    <link href="~/Scripts/jsgrid/jsgrid-theme.min.css" rel="stylesheet" />
    <link href="~/Scripts/jsgrid/jsgrid-theme.css" rel="stylesheet" />

    @*<link href="~/Content/DataTables/css/jquery.dataTables.min.css" rel="stylesheet" />*@
    @*<link href="~/Content/Site.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <script src="~/Scripts/modernizr-2.6.2.js"></script>*@
</head>
<body>
    @*<div hidden="hidden" class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">

                <span class="noti glyphicon glyphicon-bell"><span class="count">&nbsp;</span></span>
                <div class="noti-content">
                    <div class="noti-top-arrow"></div>
                    <ul id="notiContent"></ul>
                </div>

            </div>
        </div>
    </div>*@
    <input type="hidden" id="GetActionUrl" name="name" value="@Url.Action("GetActionUrl","ClientTools")" />
    <input type="hidden" id="GetAPIUrl" name="name" value="@System.Configuration.ConfigurationManager.AppSettings["ServiceUrl"]" />
    @RenderBody()
     
     
   

    <select id="PushMessage" name="" class="newsletter-field" style="height: 1%;display: none;">
        <option value="0">الرساله</option>
        <option value="1">تم التعديل</option>
    </select>

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-23581568-13');
    </script>

    @Scripts.Render("~/bundles/jquery")
    @*@Scripts.Render("~/bundles/bootstrap")*@
    @RenderSection("scripts", required: false)


    @*<script src="~/Style_design/js/vendor/modernizr-2.8.3.min.js"></script>*@
    <script src="~/ClientApp/Entities.js"></script>
    <script src="~/ClientApp/App.js"></script>
    <script src="~/ClientApp/JsGrid.js"></script>
    <script src="~/Scripts/jsgrid/jsgrid.js"></script>
    <script src="~/ClientApp/SystemTools.js"></script>
    <script src="~/ClientApp/MessageBox.js"></script>



    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/Push/push.min.js"></script>
    <script src="~/Push/serviceWorker.min.js"></script>

    @* Add Jquery Library *@
    <script src="~/Scripts/jquery-2.2.3.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.4.2.min.js"></script>
    <script src="/signalr/hubs"></script>
     
     
    @*<script src="~/Scripts/bootstrap.min.js"></script>*@
    @* Add css  *@
    @*<link href="~/Content/bootstrap.min.css" rel="stylesheet" />*@

    @*<style type="text/css">
        /*Added css for design notification area, you can design by your self*/
        /* COPY css content from youtube video description*/
        .noti-content {
            position: fixed;
            right: 100px;
            background: #e5e5e5;
            border-radius: 4px;
            top: 47px;
            width: 250px;
            display: none;
            border: 1px solid #9E988B;
        }

        ul#notiContent {
            max-height: 200px;
            overflow: auto;
            padding: 0px;
            margin: 0px;
            padding-left: 20px;
        }

            ul#notiContent li {
                margin: 3px;
                padding: 6px;
                background: #fff;
            }

        .noti-top-arrow {
            border-color: transparent;
            border-bottom-color: #F5DEB3;
            border-style: dashed dashed solid;
            border-width: 0 8.5px 8.5px;
            position: absolute;
            right: 32px;
            top: -8px;
        }

        span.noti {
            color: #FF2323;
            margin: 15px;
            position: fixed;
            right: 100px;
            font-size: 18px;
            cursor: pointer;
        }

        span.count {
            position: relative;
            top: -3px;
        }
    </style>*@

    @* Add jquery code for Get Notification & setup signalr *@
    <script type="text/javascript">
        $(function () {
            //// Click on notification icon for show notification
            //$('span.noti').click(function (e) {
            //    e.stopPropagation();
            //    $('.noti-content').show();
            //    var count = 0;
            //    count = parseInt($('span.count').html()) || 0;
            //    //only load notification if not already loaded
            //    if (count > 0) {
            //        updateNotification();
            //    }
            //    $('span.count', this).html('&nbsp;');
            //})
            //// hide notifications
            //$('html').click(function () {
            //    $('.noti-content').hide();
            //})
            //// update notification
            //function updateNotification() {
            //    debugger
            //    $('#notiContent').empty();
            //    $('#notiContent').append($('<li>Loading...</li>'));
            //    $.ajax({
            //        type: 'GET',
            //        url: '/Home/GetNotificationContacts',
            //        success: function (response) {
            //            debugger
            //            $('#notiContent').empty();
            //            if (response.length == 0) {
            //                alert("ajax success")
            //                $('#notiContent').append($('<li>No data available</li>'));
            //            }
            //            $.each(response, function (index, value) {
            //                $('#notiContent').append($('<li>New contact : ' + value.ContactName + ' (' + value.ContactNo + ') added</li>'));
            //            });
            //        },
            //        error: function (error) {
            //            console.log(error);
            //        }
            //    })
            //}
            //// update notification count
            //function updateNotificationCount() {
            //    var count = 0;
            //    count = parseInt($('span.count').html()) || 0;
            //    count++;
            //    $('span.count').html(count);
            //}
            // signalr js code for start hub and send receive notification



                var notificationHub = $.connection.notificationHub;
                $.connection.hub.start().done(function () {
                    console.log('Notification hub started');
                });
                //signalr method for push server message to client
                notificationHub.client.notify = function (message) {
                    if (message && message.toLowerCase() == "added") {
                        //debugger
                        //alert("updateNotificationCount");

                        //alert(sessionStorage.getItem("page"))

                        var page = sessionStorage.getItem("page");

                     



                        if (page == '5') {

                            
                            $('#PushMessage option[value=1]').prop('selected', 'selected').change();
                            var CheakBranch = sessionStorage.getItem("CheakBranch");
                            if (CheakBranch == 'true') {
                                start();
                                sessionStorage.setItem("CheakBranch", "");    
                            }

                           
                        }


                     
                    }
                }

         


          

        })



        function start() {
            //Push.create('Hello World!')

            Push.create("( "+$("#txt_Branch option:selected").text() + " ) أسمه أيه؟ ", {
                body: "" + $('#Home_Num_Dor').html() + "",
                icon: '../images/logo_samah_New.png',
                timeout: 9000,
                onClick: function () {
                    window.focus();
                    this.close();
                }
            });

        }


      
    </script>

</body>
</html>
